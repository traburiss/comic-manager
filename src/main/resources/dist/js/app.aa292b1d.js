(function(e){function t(t){for(var r,o,i=t[0],l=t[1],u=t[2],m=0,d=[];m<i.length;m++)o=i[m],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&d.push(s[o][0]),s[o]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);c&&c(t);while(d.length)d.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,i=1;i<n.length;i++){var l=n[i];0!==s[l]&&(r=!1)}r&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},s={app:0},a=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var c=l;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"03db":function(e,t,n){"use strict";var r=n("1078"),s=n.n(r);s.a},1078:function(e,t,n){},"289e":function(e,t,n){"use strict";var r=n("e8f7"),s=n.n(r);s.a},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("f771");var r,s=n("2b0e"),a=n("5c96"),o=n.n(a),i=(n("e05f"),n("0fae"),n("8c4f")),l=n("2b27"),u=n.n(l),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",{staticClass:"container"},[n("el-header",{staticClass:"header",attrs:{height:"30px"}},[n("el-menu",{attrs:{"default-active":e.activeIndex,mode:"horizontal",router:!0}},[n("el-submenu",{attrs:{index:"myself","show-timeout":100,"hide-timeout":100}},[n("template",{slot:"title"},[e._v("我")]),n("el-menu-item",{attrs:{index:"me"}},[e._v(e._s(e.userData.userName))]),n("el-menu-item",{on:{click:function(t){return e.$refs.editUserName.open()}}},[e._v("修改用户名")]),n("el-menu-item",{on:{click:function(t){return e.$refs.editPassword.open()}}},[e._v("修改密码")]),n("el-menu-item",{staticClass:"logout",on:{click:e.logout}},[e._v("登出")])],2),e.menuList.includes("user")?n("el-submenu",{attrs:{index:"manager","show-timeout":100,"hide-timeout":100}},[n("template",{slot:"title"},[e._v("管理")]),e.menuList.includes("user")?n("el-menu-item",{attrs:{index:"user"}},[e._v("用户")]):e._e(),e.menuList.includes("user")?n("el-menu-item",{attrs:{index:"role"}},[e._v("角色")]):e._e(),e.menuList.includes("user")?n("el-menu-item",{attrs:{index:"library"}},[e._v("书库")]):e._e(),e.menuList.includes("user")?n("el-menu-item",{attrs:{index:"config"}},[e._v("配置")]):e._e()],2):e._e(),e.menuList.includes("user")?n("el-menu-item",{attrs:{index:"series"}},[e._v("系列")]):e._e(),e.menuList.includes("user")?n("el-menu-item",{attrs:{index:"comic"}},[e._v("漫画")]):e._e(),e.menuList.includes("user")?n("el-menu-item",{attrs:{index:"search"}},[e._v("搜索")]):e._e()],1)],1),n("el-main",{staticClass:"main"},[n("router-view")],1),n("edit-user-name",{ref:"editUserName"}),n("edit-password",{ref:"editPassword"})],1)},m=[],d=(n("ac1f"),n("5319"),n("d3b7"),n("bc3a")),f=n.n(d),p={start:function(e){r=a["Loading"].service({text:e,lock:!0})},stop:function(){r&&r.close()}},h={token:"token"};f.a.defaults.baseURL="/api",f.a.interceptors.response.use((function(e){try{if(200===e.status){var t=e.data;return 200===t.code?Promise.resolve(t):(a["Message"].error(t.msg),Promise.reject(t))}if(401!==e.status){var n=e.data;return void 0!==n&&null!==n?(a["Message"].error(n.msg),Promise.reject(n)):(a["Message"].error(e.statusText),Promise.reject({code:e.status,msg:e.statusText}))}p.stop(),ct.app.$cookies.remove(h.token,"/"),ct.app.$router.push("/login").then((function(){a["Message"].error("你还未登陆，请先登陆")}))}catch(r){return console.error(r),a["Message"].error("未知错误，请稍后重试"),Promise.reject({code:-1,msg:"未知错误，请稍后重试"})}}));var g={service:function(e,t,n){return f()({method:t,url:e,data:n})},post:function(e,t){return this.service(e,"post",t)},get:function(e,t){return this.service(e,"get",t)}},v=n("6c27"),w=n.n(v),b={loginService:function(e,t){return g.post("/user/login",{loginName:e,passWord:w.a.sha256(t)})},logoutService:function(){return g.post("/user/logout",{})}},_=(n("4160"),n("159b"),n("ade3")),x=n("2f62"),$={userData:function(){return g.get("/user/data",{})},editUserName:function(e){return g.post("/user/update/username",{userName:e})},editPassword:function(e,t){return g.post("/user/update/password",{pwd:w.a.sha256(e),newPwd:w.a.sha256(t)})}},P="updateUserData";s["default"].use(x["a"]);var y=new x["a"].Store({state:{userData:{userName:"",loginName:"",roleName:"",menuList:[]},menuList:[]},mutations:Object(_["a"])({},P,(function(e){$.userData().then((function(t){e.userData=t["data"],e.menuList=[],e.userData.menuList.forEach((function(t){e.menuList.push(t["menuCode"])}))}))}))}),N=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:"修改用户名",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-form",{ref:"userNameForm",attrs:{model:e.user,rules:e.rules,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"旧用户名"}},[n("el-input",{attrs:{disabled:!0},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}})],1),n("el-form-item",{attrs:{label:"新用户名",prop:"newUserName"}},[n("el-input",{attrs:{placeholder:"请输入新的用户名",clearable:!0},model:{value:e.user.newUserName,callback:function(t){e.$set(e.user,"newUserName",t)},expression:"user.newUserName"}})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.close}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("确 定")])],1)],1)},j=[],k={name:"EditUserName",data:function(){return{dialogVisible:!1,user:{newUserName:""},rules:{newUserName:[{required:!0,message:"请输入新的用户名",trigger:"change"},{min:1,max:30,message:"长度在 1 到 30 个字符",trigger:"change"}]}}},computed:{userName:function(){return this.$store.state.userData.userName}},methods:{open:function(){this.dialogVisible=!0},close:function(){this.user.newUserName="",this.dialogVisible=!1,this.$refs.userNameForm.resetFields()},update:function(){var e=this;this.$refs.userNameForm.validate((function(t){t&&(p.start("正在修改"),$.editUserName(e.user.newUserName).then((function(t){200===t.code?(e.$message.success("修改成功"),e.$store.commit(P),e.close()):e.$message.warning(t.msg)})).finally((function(){p.stop()})))}))}}},O=k,E=n("2877"),C=Object(E["a"])(O,N,j,!1,null,"65e78b54",null),L=C.exports,U=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:"修改密码",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-form",{ref:"editPwdFrom",attrs:{model:e.user,"label-width":"80px",rules:e.rules}},[n("el-form-item",{attrs:{label:"旧密码",prop:"oldPwd"}},[n("el-input",{attrs:{placeholder:"请输入旧的密码","show-password":"",clearable:!0},model:{value:e.user.oldPwd,callback:function(t){e.$set(e.user,"oldPwd",t)},expression:"user.oldPwd"}})],1),n("el-form-item",{attrs:{label:"新密码",prop:"newPwd"}},[n("el-input",{attrs:{placeholder:"请输入新的密码","show-password":"",clearable:!0},model:{value:e.user.newPwd,callback:function(t){e.$set(e.user,"newPwd",t)},expression:"user.newPwd"}})],1),n("el-form-item",{attrs:{label:"新密码",prop:"newPwdAgain"}},[n("el-input",{attrs:{placeholder:"请再次输入新的密码","show-password":"",clearable:!0},model:{value:e.user.newPwdAgain,callback:function(t){e.$set(e.user,"newPwdAgain",t)},expression:"user.newPwdAgain"}})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.close}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("确 定")])],1)],1)},S=[],M={name:"EditPassword",data:function(){var e=this,t=function(t,n,r){""===n?r(new Error("请再次输入密码")):n.length<6||n.length>30?r(new Error("长度在 6 到 30 个字符")):n!==e.user.newPwd?r(new Error("两次输入密码不一致!")):r()};return{dialogVisible:!1,user:{oldPwd:"",newPwd:"",newPwdAgain:""},rules:{oldPwd:[{required:!0,message:"请输入旧的密码",trigger:"change"},{min:6,max:30,message:"长度在 6 到 30 个字符",trigger:"change"}],newPwd:[{required:!0,message:"请输入新的密码",trigger:"change"},{min:6,max:30,message:"长度在 6 到 30 个字符",trigger:"change"}],newPwdAgain:[{validator:t,trigger:"change"}]}}},methods:{open:function(){this.dialogVisible=!0},close:function(){this.user={oldPwd:"",newPwd:"",newPwdAgain:""},this.dialogVisible=!1,this.$refs.editPwdFrom.resetFields()},update:function(){var e=this;this.$refs.editPwdFrom.validate((function(t){t&&(p.start("正在修改"),$.editPassword(e.user.oldPwd,e.user.newPwdAgain).then((function(t){200===t.code?(e.$message.success("修改成功"),e.close(),p.stop(),e.$confirm("您已修改密码，请问是否要重新登陆","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){p.start("正在登出"),b.logoutService().then((function(){p.stop(),e.$cookies.remove(h.token,"/"),e.$router.push("/login"),e.$message({message:"已登出!"})})).catch((function(){p.stop(),e.$message({type:"warn",message:"登出失败"})}))}))):e.$message.warning(t.msg)})).finally((function(){p.stop()})))}))}}},D=M,F=Object(E["a"])(D,U,S,!1,null,"779ae631",null),V=F.exports,A={name:"Home",components:{EditUserName:L,EditPassword:V},data:function(){return{activeIndex:"search"}},methods:{logout:function(){var e=this;this.$confirm("请再考虑一下下","登出",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",showClose:!1,confirmButtonClass:"el-button--danger"}).then((function(){p.start("正在登出"),b.logoutService().then((function(){e.logoutFinish()})).catch((function(){p.stop(),e.$message({type:"warn",message:"登出失败"})}))})).catch((function(){e.$message({type:"info",message:"已取消"})}))},logoutFinish:function(){p.stop(),this.$cookies.remove(h.token,"/"),this.$router.push("/login"),this.$message({message:"已登出!"})}},computed:{userData:function(){return this.$store.state.userData},menuList:function(){return this.$store.state.menuList}},mounted:function(){this.activeIndex=this.$route.path.replace("/home/",""),this.$store.commit(P)}},T=A,W=(n("03db"),Object(E["a"])(T,c,m,!1,null,null,null)),B=W.exports,R=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",{staticClass:"container"},[n("el-main",{staticClass:"main"},[n("el-row",{staticClass:"main-row"},[n("el-col",{staticClass:"title-col",attrs:{xs:24,sm:24,md:16,lg:16,xl:16}},[e._v(" "+e._s(e.msg)+" ")]),n("el-col",{staticClass:"from-col",attrs:{xs:24,sm:24,md:8,lg:8,xl:8}},[n("el-form",{ref:"from",staticClass:"login-from",attrs:{model:e.login}},[n("el-form-item",{staticClass:"from-label"},[n("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.login.userName,callback:function(t){e.$set(e.login,"userName",t)},expression:"login.userName"}})],1),n("el-form-item",{staticClass:"from-label"},[n("el-input",{attrs:{placeholder:"请输入密码","show-password":""},model:{value:e.login.passWord,callback:function(t){e.$set(e.login,"passWord",t)},expression:"login.passWord"}})],1),n("el-form-item",{staticClass:"from-label"},[n("el-button",{staticClass:"login-button",attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("登陆")])],1)],1)],1),n("el-col",{staticClass:"picture-col hidden-sm-and-down",attrs:{h:"",md:24,lg:24,xl:24}})],1)],1)],1)},q=[],I={name:"Login",props:{msg:String},data:function(){return{login:{userName:"",passWord:""}}},methods:{onSubmit:function(){var e=this;this.$message.info("正在登陆"),b.loginService(this.login.userName,this.login.passWord).then((function(){e.$message.success("登陆成功"),e.$router.push("/home")}))}}},J=I,z=(n("289e"),Object(E["a"])(J,R,q,!1,null,"772939a2",null)),H=z.exports,G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h1",[e._v("404")])},K=[],Q={name:"Error"},X=Q,Y=Object(E["a"])(X,G,K,!1,null,null,null),Z=Y.exports,ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h1",[e._v("this is search")])},te=[],ne={name:"Search"},re=ne,se=Object(E["a"])(re,ee,te,!1,null,"1ff0734c",null),ae=se.exports,oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h1",[e._v("comic manager")])},ie=[],le={name:"ComicManager"},ue=le,ce=Object(E["a"])(ue,oe,ie,!1,null,"c144b8f2",null),me=ce.exports,de=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h1",[e._v("series manager")])},fe=[],pe={name:"SeriesManager"},he=pe,ge=Object(E["a"])(he,de,fe,!1,null,"68df026e",null),ve=ge.exports,we=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},be=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h1",[n("s",[e._v("因吹斯听")]),e._v(" library")])}],_e={name:"Library"},xe=_e,$e=Object(E["a"])(xe,we,be,!1,null,"6e706473",null),Pe=$e.exports,ye=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h1",[e._v("user manager")])},Ne=[],je={name:"UserManeger"},ke=je,Oe=Object(E["a"])(ke,ye,Ne,!1,null,"c45fc6a2",null),Ee=Oe.exports,Ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h1",[e._v("Role")])},Le=[],Ue={name:"RoleManager"},Se=Ue,Me=Object(E["a"])(Se,Ce,Le,!1,null,"3ba15fca",null),De=Me.exports,Fe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h1",[e._v("config manager")])},Ve=[],Ae={name:"ComicManager"},Te=Ae,We=Object(E["a"])(Te,Fe,Ve,!1,null,"f6e3e6f4",null),Be=We.exports,Re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h1",[e._v("this me")])},qe=[],Ie={name:"Me"},Je=Ie,ze=Object(E["a"])(Je,Re,qe,!1,null,"524615f6",null),He=ze.exports,Ge=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h1",[e._v("Comic reader")])},Ke=[],Qe={name:"ComicRead"},Xe=Qe,Ye=Object(E["a"])(Xe,Ge,Ke,!1,null,"5f563de6",null),Ze=Ye.exports,et={routers:[{path:"",redirect:"/home"},{path:"/",redirect:"/home"},{path:"/home",component:B,children:[{path:"",redirect:"search"},{path:"search",component:ae},{path:"comic",component:me},{path:"series",component:ve},{path:"library",component:Pe},{path:"user",component:Ee},{path:"role",component:De},{path:"config",component:Be},{path:"me",component:He}]},{path:"/comic/reader",component:Ze},{path:"/login",component:H},{path:"/404",component:Z},{path:"/*",redirect:"/404"}]},tt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},nt=[],rt={name:"App"},st=rt,at=Object(E["a"])(st,tt,nt,!1,null,null,null),ot=at.exports;s["default"].config.productionTip=!1,s["default"].use(o.a),s["default"].use(i["a"]),s["default"].use(u.a);var it=new i["a"]({mode:"history",base:"/",routes:et.routers}),lt=new s["default"]({render:function(e){return e(ot)},store:y,router:it}).$mount("#app");function ut(){return null!==lt.$cookies.get(h.token)}it.beforeEach((function(e,t,n){ut()||"/login"===e.path?n():(lt.$message.error("您还没有登陆，请重新登陆"),n("/login"))}));var ct=t["default"]={app:lt}},e8f7:function(e,t,n){},f771:function(e,t,n){}});
//# sourceMappingURL=app.aa292b1d.js.map